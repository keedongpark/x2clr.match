# 매칭 

## 인스턴스 기반 

 - 주로 온라인 게임 / MO에서 사용
 - 지역별 인스턴스 / 인던의 정보를 한 곳에서 기억
 - 인스턴스의 정보를 매칭 케이스와 동기화 
 - 요청이 오면 적절한 곳에 투입 
 - 개별 인스턴스의 판단에 따라 소멸. 통보. 
   - 이 때 주의해야 함. 상태 불일치 발생할 수 있음. 

## 매칭 기반 

 - 잘 없던 방식인데 클래시 오브 클랜, 클래시 로얄에서 등장 
 - 매판을 새로운 사용자와 매칭하는 방식. 
 - 사용자 중심으로 인스턴스 생성 방식 
 - 인스턴스 정보를 중앙에서 관리할 필요가 없음 
 - 고전적인 고포류의 보드 게임도 위와 같이 매칭 가능 
 - 간결하며 부담이 적은 방식 

## 레퍼런스 구현 

 - 매칭 기반 방식으로 진행 
 - 일정 시간 지나도 상대가 없으면 봇과 매칭 시킴 
 - 매판 인스턴스 나오고 매칭하고 인스턴스 들어가는 방식 

# 구현 

## InstanceCoordinator의 상태 정보 

 - 상태 변경 시 통보 
 - 서버 시작 순서에 관계 없으려면 주기적인 전송 필요 
 - 따라서, 타이머 필요 
 
## 타이머 

 - 타잎 + 문맥 값으로 처리 
 - Case 단위를 타잎으로 분리하고 타잎 내에서 문맥으로 분리 

 




